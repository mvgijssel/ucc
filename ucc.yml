# the configuration of the application
config:

  exclude_models: User

  # the target database tables
  db:

    # the user table
    user:
      name: user
      id: id

    # the user group table
    group:
      name: usergroup
      id: id

    # the relationship database, connecting users to user groups
    membership:
      name: group_membership
      id: id
      user_id: user_id
      group_id: group_id

  # the code weaving configuration
  weaving:
    model: request / inherited / preload # how the weaving of functionality is done
    controller: request / inherited / preload # how the weaving of functionality is done


# all the container definitions + request matching rules
container:

  root:    
    id: 1
    controller: application_controller
    groups:
      admin

  # model name of the container
  project:
    controller: projects_controller
    model: project
    id: 2

    # the user groups the container creates
    groups:
      # user groups created by the container
       # -> something like: project_user_1_group, 1 is the id of the project model
      project_user
      project_admin


# the sets / containers / folders of the application with associated security
security:

  root:
    pages_controller:
      everyone:
        allow: ~
    media_controller:
      everyone:
        allow: ~

    # nesting of the containers, determines how the matching is done
    # this case: MUST MATCH root + project -> nil + project_id -> project_id
    project:
      pages_controller:
        project_user:
          allow:
            index
            show
        project_admin:
          allow: ~

